Here's a step-by-step guide to install **k0s** on Ubuntu 20.04. **k0s** is a lightweight, zero-friction Kubernetes distribution by Mirantis, suitable for both development and production.

### Step 1: Update the System

Start by updating your package lists and upgrading any packages:

```bash
sudo apt update && sudo apt upgrade -y
```

### Step 2: Download the k0s Binary

1. Download the latest k0s binary:

   ```bash
   curl -sSLf https://get.k0s.sh | sudo sh
   ```

2. **Verify Installation**:
   - Check that k0s has been installed correctly:

     ```bash
     k0s version
     ```

### Step 3: Install k0s as a Single-Node Cluster

To set up a single-node cluster, you’ll install k0s in controller mode with the `--single` flag.

1. **Install k0s** as a single-node controller:

   ```bash
   sudo k0s install controller --single
   ```

2. **Start k0s**:

   ```bash
   sudo k0s start
   ```

3. **Verify k0s Status**:

   ```bash
   sudo k0s status
   ```

### Step 4: Configure kubectl to Access the Cluster

k0s includes a configuration file for `kubectl` access. Set up `kubectl` by linking to the configuration file:

1. Create a directory for the Kubernetes config if it doesn’t exist:

   ```bash
   mkdir -p ~/.kube
   ```

2. Copy the k0s kubeconfig file:

   ```bash
   sudo cp /var/lib/k0s/pki/admin.conf ~/.kube/config
   sudo chown $(id -u):$(id -g) ~/.kube/config
   ```

3. **Verify Cluster Access**:

   Check the cluster status using `kubectl`:

   ```bash
   kubectl get nodes
   ```

   This should display your single-node cluster.

### Step 5: Enable k0s as a System Service (Optional)

To have k0s start automatically on system boot, use the following command:

```bash
sudo systemctl enable k0scontroller
```

### Step 6: Check Cluster Status
Install kubectl
```bash
echo "deb [signed-by=/etc/apt/keyrings/kubernetes-apt-keyring.gpg] https://pkgs.k8s.io/core:/stable:/v1.28/deb/ /" | sudo tee /etc/apt/sources.list.d/kubernetes.list

curl -fsSL https://pkgs.k8s.io/core:/stable:/v1.28/deb/Release.key | sudo gpg --dearmor -o /etc/apt/keyrings/kubernetes-apt-keyring.gpg
```
Install kubectl, kubeadmin and kublet:
```bash
sudo apt update
sudo apt install -y kubectl
```
Use the following command to verify that the k0s cluster is running and healthy:
```bash
kubectl get all --all-namespaces
```

### Optional: Adding Worker Nodes: You will not be able to add worker node to a single cluster

To add worker nodes to this controller, generate a token on the controller node:

```bash
sudo k0s token create --role=worker
```

Then, on each worker node, install k0s and use this token to join the worker to the cluster:

```bash
curl -sSLf https://get.k0s.sh | sudo sh
sudo k0s install worker --token <your-worker-token>
sudo k0s start
```

### Summary

- **Download** and install k0s.
- **Start k0s** as a single-node controller.
- **Set up kubectl** to interact with the cluster.
- Optionally, **enable k0s** as a system service and add worker nodes if needed.

Your single-node k0s Kubernetes cluster should now be up and running on Ubuntu 20.04.
